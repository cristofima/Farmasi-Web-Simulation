<br />
<p-confirmDialog [style]="{width: '30vw'}" rejectButtonStyleClass="p-button-outlined"></p-confirmDialog>
<p-button (click)="showDialog = true" label="Nueva simulación"></p-button>
<br />

<div class="card">
  <p-table [value]="simulations" dataKey="id" [tableStyle]="{'min-width': '60rem'}">
    <ng-template pTemplate="caption">Simulaciones</ng-template>
    <ng-template pTemplate="header">
      <tr>
        <th style="width: 5rem"></th>
        <th pSortableColumn="name">Nombre <p-sortIcon field="name"></p-sortIcon></th>
        <th pSortableColumn="title">Título <p-sortIcon field="title"></p-sortIcon></th>
        <th pSortableColumn="grupalVolumne">Volumen Grupal <p-sortIcon field="grupalVolumne"></p-sortIcon></th>
        <th pSortableColumn="sidePoints">Puntos Laterales <p-sortIcon field="sidePoints"></p-sortIcon>
        </th>
        <th pSortableColumn="totalBonus">Bono Mensual <p-sortIcon field="totalBonus"></p-sortIcon></th>
        <th pSortableColumn="creationDate">Fecha Creación <p-sortIcon field="creationDate"></p-sortIcon>
        </th>
        <th pSortableColumn="lastUpdateDate">Última Modificación <p-sortIcon field="lastUpdateDate"></p-sortIcon></th>
        <th></th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-simulation let-expanded="expanded">
      <tr>
        <td>
          <button type="button" pButton pRipple [pRowToggler]="simulation"
            class="p-button-text p-button-rounded p-button-plain"
            [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
        </td>
        <td>{{simulation.name}}</td>
        <td>{{simulation.title}}</td>
        <td>{{simulation.grupalVolume}}</td>
        <td>{{simulation.sidePoints}}</td>
        <td>{{simulation.totalBonus | currency}}</td>
        <td>{{simulation.creationDate | date: 'medium' }}</td>
        <td>{{simulation.lastUpdateDate | date: 'medium'}}</td>
        <td>
          <div class="flex flex-wrap gap-3 justify-content-center">
            <p-button (onClick)="goToDetails(simulation.id)" icon="pi pi-folder" styleClass="p-button-info"></p-button>
            <p-button (onClick)="deleteSimulation(simulation)" icon="pi pi-trash"
              styleClass="p-button-danger"></p-button>
          </div>
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="rowexpansion" let-details>
      <tr>
        <td colspan="9">
          <div class="p-3">
            <p-card header="Bonos Mensuales">
              <p class="m-0">
                <b>Bono Personal:</b> {{details?.personalBonus | currency}}
              </p>
              <p class="m-0">
                <b>Bono de Grupo:</b> {{details?.grupalBonus | currency}}
              </p>
              <p class="m-0">
                <b>Bono de Auto:</b> {{details?.carBonus | currency}}
              </p>
              <p class="m-0">
                <b>Bono de Liderazgo:</b>
              </p>
              <ul>
                <li *ngFor="let leadershipBonus of details?.leadershipBonusArr; let i = index">
                  <b>Gen {{i + 1}}:</b> {{leadershipBonus | currency}}
                </li>
              </ul>
            </p-card>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<br />

<p-dialog header="Nueva simulación" [(visible)]="showDialog" [style]="{width: '30vw'}" [modal]="true"
  [draggable]="false">
  <div class="card flex flex-wrap gap-3 p-fluid">
    <div class="flex flex-column gap-2">
      <label for="name">Nombre</label>
      <input pInputText id="name" [(ngModel)]="name" />
    </div>
  </div>
  <ng-template pTemplate="footer">
    <p-button (click)="addSimulation()" label="Guardar"></p-button>
  </ng-template>
</p-dialog>
